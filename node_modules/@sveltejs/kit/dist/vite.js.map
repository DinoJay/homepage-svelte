{"version":3,"file":"vite.js","sources":["../src/api/dev/vite.js"],"sourcesContent":["import express from 'express';\nimport { readFileSync } from 'fs';\nimport { join } from 'path';\nimport { parse, URLSearchParams } from 'url';\nimport { EventEmitter } from 'events';\nimport CheapWatch from 'cheap-watch';\nimport { scorta } from 'scorta/sync';\nimport sirv from 'sirv';\nimport amp_validator from 'amphtml-validator';\nimport vite from 'vite';\nimport create_manifest_data from '../../core/create_manifest_data';\nimport { create_app } from '../../core/create_app';\nimport { mkdirp } from '@sveltejs/app-utils/files';\nimport { render } from '../../renderer';\nimport { get_body } from '@sveltejs/app-utils/http';\nimport { copy_assets } from '../utils';\n\nexport function dev(opts) {\n\treturn new Watcher(opts).init();\n}\n\nclass Watcher extends EventEmitter {\n\tconstructor({ port, config }) {\n\t\tsuper();\n\n\t\tthis.cachedir = scorta('svelte');\n\t\tthis.port = port;\n\t\tthis.config = config;\n\t\tthis.update();\n\n\t\tprocess.env.NODE_ENV = 'development';\n\n\t\tprocess.on('exit', () => {\n\t\t\tthis.close();\n\t\t});\n\t}\n\n\tasync init() {\n\t\tmkdirp('.svelte');\n\n\t\tcopy_assets();\n\n\t\tawait this.init_filewatcher();\n\t\tawait this.init_server();\n\n\t\treturn this;\n\t}\n\n\tasync init_filewatcher() {\n\t\tthis.cheapwatch = new CheapWatch({\n\t\t\tdir: this.config.files.routes,\n\t\t\tfilter: ({ path }) => path.split('/').every((part) => !part.startsWith('_'))\n\t\t});\n\n\t\tawait this.cheapwatch.init();\n\n\t\t// not sure why TS doesn't understand that CheapWatch extends EventEmitter\n\t\tthis.cheapwatch.on('+', ({ isNew }) => {\n\t\t\tif (isNew) this.update();\n\t\t});\n\n\t\tthis.cheapwatch.on('-', () => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\n\tasync init_server() {\n\t\t/**\n\t\t * @type {vite.ViteDevServer}\n\t\t */\n\t\tthis.viteDevServer = await vite.createServer({\n\t\t\tserver: {\n\t\t\t  middlewareMode: true\n\t\t\t}\n\t\t});\n\n\t\tconst app_dir = this.config.appDir;\n\t\tconst {\n\t\t\tset_paths\n\t\t} = await this.viteDevServer.ssrLoadModule(`/${app_dir}/assets/runtime/internal/singletons.js`);\n\n\t\tset_paths(this.config.paths);\n\n\t\tconst static_handler = sirv(this.config.files.assets, {\n\t\t\tdev: true\n\t\t});\n\n\t\tconst validator = this.config.amp && (await amp_validator.getInstance());\n\n\t\tthis.server = express();\n\n\t\tthis.server.use(sirv('static', { dev }));\n\n\t\t// use viteDevServer's connect instance as middleware\n\t\tthis.server.use(this.viteDevServer.middlewares);\n\n\t\tthis.server.use('*', async (req, res, next) => {\n\t\t\ttry {\n\t\t\t\tconst parsed = parse(req.originalUrl);\n\n\t\t\t\tstatic_handler(req, res, async () => {\n\t\t\t\t\tif (req.originalUrl === '/favicon.ico') return;\n\n\t\t\t\t\t// handle dynamic requests - i.e. pages and endpoints\n\t\t\t\t\tconst template = readFileSync(this.config.files.template, 'utf-8');\n\n\t\t\t\t\tlet setup;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsetup = (await this.viteDevServer.ssrLoadModule(`/${app_dir}/setup/index.js`));\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tsetup = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tlet root;\n\n\t\t\t\t\ttry {\n//\t\t\t\t\t\troot = (await this.viteDevServer.ssrLoadModule(`/${app_dir}/assets/generated/root.svelte.js`)).default;\n\t\t\t\t\t\troot = (await this.viteDevServer.ssrLoadModule(`/${app_dir}/assets/generated/root.svelte`)).default;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tres.statusCode = 500;\n\t\t\t\t\t\tres.end(e.stack);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst body = await get_body(req);\n\n\t\t\t\t\tconst rendered = await render(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\theaders: req.headers,\n\t\t\t\t\t\t\tmethod: req.method,\n\t\t\t\t\t\t\tpath: parsed.pathname,\n\t\t\t\t\t\t\tquery: new URLSearchParams(parsed.query),\n\t\t\t\t\t\t\tbody\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpaths: this.config.paths,\n\t\t\t\t\t\t\ttemplate: ({ head, body }) => {\n\t\t\t\t\t\t\t\tlet rendered = template\n\t\t\t\t\t\t\t\t\t.replace('%svelte.head%', () => head)\n\t\t\t\t\t\t\t\t\t.replace('%svelte.body%', () => body);\n\n\t\t\t\t\t\t\t\tif (this.config.amp) {\n\t\t\t\t\t\t\t\t\tconst result = validator.validateString(rendered);\n\n\t\t\t\t\t\t\t\t\tif (result.status !== 'PASS') {\n\t\t\t\t\t\t\t\t\t\tconst lines = rendered.split('\\n');\n\n\t\t\t\t\t\t\t\t\t\tconst escape = (str) =>\n\t\t\t\t\t\t\t\t\t\t\tstr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\n\t\t\t\t\t\t\t\t\t\trendered = `<!doctype html>\n\t\t\t\t\t\t\t\t\t\t\t<head>\n\t\t\t\t\t\t\t\t\t\t\t\t<meta charset=\"utf-8\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<style>\n\t\t\t\t\t\t\t\t\t\t\t\t\tbody {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: #333;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tpre {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: #f4f4f4;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpadding: 1em;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toverflow-x: auto;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t</style>\n\t\t\t\t\t\t\t\t\t\t\t</head>\n\t\t\t\t\t\t\t\t\t\t\t<h1>AMP validation failed</h1>\n\n\t\t\t\t\t\t\t\t\t\t\t${result.errors\n\t\t\t\t\t\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(error) => `\n\t\t\t\t\t\t\t\t\t\t\t\t<h2>${error.severity}</h2>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>Line ${error.line}, column ${error.col}: ${error.message} (<a href=\"${error.specUrl}\">${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\terror.code\n\t\t\t\t\t\t\t\t\t\t\t\t\t}</a>)</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<pre>${escape(lines[error.line - 1])}</pre>\n\t\t\t\t\t\t\t\t\t\t\t`\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t.join('\\n\\n')}\n\t\t\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn rendered;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmanifest: this.manifest,\n\t\t\t\t\t\t\ttarget: this.config.target,\n\t\t\t\t\t\t\tentry: 'assets/runtime/internal/start.js',\n\t\t\t\t\t\t\tdev: true,\n\t\t\t\t\t\t\tamp: this.config.amp,\n\t\t\t\t\t\t\troot,\n\t\t\t\t\t\t\tsetup,\n\t\t\t\t\t\t\tonly_prerender: false,\n\t\t\t\t\t\t\tstart_global: this.config.startGlobal,\n\t\t\t\t\t\t\tapp_dir,\n\t\t\t\t\t\t\thost: this.config.host,\n\t\t\t\t\t\t\thost_header: this.config.hostHeader,\n\t\t\t\t\t\t\tget_stack: (error) => error.stack, // TODO: use viteDevServer.ssrFixStacktrace?\n\t\t\t\t\t\t\tget_static_file: (file) => readFileSync(join(this.config.files.assets, file)),\n\t\t\t\t\t\t\tget_amp_css: (url) => '' // TODO: implement this\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (rendered) {\n\t\t\t\t\t\tres.writeHead(rendered.status, rendered.headers);\n\t\t\t\t\t\tres.end(rendered.body);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres.statusCode = 404;\n\t\t\t\t\t\tres.end('Not found');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tthis.viteDevServer.ssrFixStacktrace(e);\n\t\t\t\tconsole.log(e.stack);\n\t\t\t\tnext(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.server.listen(this.port);\n\t}\n\n\tupdate() {\n\t\tconst manifest_data = create_manifest_data(this.config);\n\n\t\tcreate_app({\n\t\t\tmanifest_data,\n\t\t\toutput: '.svelte/assets'\n\t\t});\n\n\t\tconst common_css_deps = new Set();\n\n\t\tthis.manifest = {\n\t\t\tassets: manifest_data.assets,\n\t\t\tlayout: async () => {\n\t\t\t\t// TODO: CSS support\n\t\t\t\t// const { exports, css } = await this.load(manifest_data.layout.url);\n\t\t\t\t// css.forEach((dep) => common_css_deps.add(dep));\n\t\t\t\t// return exports;\n\n\t\t\t\treturn await this.viteDevServer.ssrLoadModule(manifest_data.layout.url);\n\t\t\t},\n\t\t\terror: async () => {\n\t\t\t\t// TODO: CSS support\n\t\t\t\t// const { exports, css } = await this.load(manifest_data.error.url);\n\t\t\t\t// css.forEach((dep) => common_css_deps.add(dep));\n\t\t\t\t// return exports;\n\n\t\t\t\treturn await this.viteDevServer.ssrLoadModule(manifest_data.error.url);\n\t\t\t},\n\t\t\tpages: manifest_data.pages.map((data) => {\n\t\t\t\t// This is a bit of a hack, but it means we can inject the correct <link>\n\t\t\t\t// elements without needing to do any analysis before loading\n\t\t\t\tconst css_deps = new Set();\n\n\t\t\t\treturn {\n\t\t\t\t\tpattern: data.pattern,\n\t\t\t\t\tparams: get_params(data.params),\n\t\t\t\t\tparts: data.parts.map(({ url }) => async () => {\n\t\t\t\t\t\t// TODO: CSS support\n\t\t\t\t\t\t// const { exports, css } = await this.load(url);\n\t\t\t\t\t\t// common_css_deps.forEach((url) => css_deps.add(url));\n\t\t\t\t\t\t// css.forEach((url) => css_deps.add(url));\n\t\t\t\t\t\t// return exports;\n\n\t\t\t\t\t\treturn await this.viteDevServer.ssrLoadModule(url);\n\t\t\t\t\t}),\n\t\t\t\t\tget css() {\n\t\t\t\t\t\treturn Array.from(css_deps);\n\t\t\t\t\t},\n\t\t\t\t\tjs: []\n\t\t\t\t};\n\t\t\t}),\n\t\t\tendpoints: manifest_data.endpoints.map((data) => ({\n\t\t\t\tpattern: data.pattern,\n\t\t\t\tparams: get_params(data.params),\n\t\t\t\tload: async () => await this.viteDevServer.ssrLoadModule(data.url)\n\t\t\t}))\n\t\t};\n\t}\n\n\tclose() {\n\t\tif (this.closed) return;\n\t\tthis.closed = true;\n\n\t\tthis.server.close();\n\t\tthis.cheapwatch.close();\n\t}\n}\n\n// given an array of params like `['x', 'y', 'z']` for\n// src/routes/[x]/[y]/[z]/svelte, create a function\n// that turns a RexExpMatchArray into ({ x, y, z })\nfunction get_params(array) {\n\treturn (match) => {\n\t\tconst params = {};\n\t\tarray.forEach((key, i) => {\n\t\t\tif (key.startsWith('...')) {\n\t\t\t\tparams[key.slice(3)] = decodeURIComponent(match[i + 1]).split('/');\n\t\t\t} else {\n\t\t\t\tparams[key] = decodeURIComponent(match[i + 1]);\n\t\t\t}\n\t\t});\n\t\treturn params;\n\t};\n}\n"],"names":["mkdirp","amp_validator","get_body"],"mappings":"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"}